<style>
  @media print {
    @page {
      /* size: 210mm 297mm;  */
      /* size: 21,0cm 29,7cm;  */
      /* size: 88,27" x 11,69";  */
      /* size: 2 480 x 3 508px;  */
      /* size:  595 x 842px;  */

      margin: 0mm 0mm 0mm 0mm;
    }
  /**/

    * {
      -webkit-print-color-adjust: exact !important;
      /* Chrome, Safari, Edge */
      color-adjust: exact !important;
    }

    .modal-footer {
      display: none !important;
    }

    .mian-col-purchase .main-table td {
      padding: 2px 0px !important;
      color: #000 !important;
      font-size: 10px !important;
    }

    .main-head-col {
      border: 2px solid #000;
      background: #e6e6e6 !important;
      text-align: center;
      font-weight: 600;
      font-size: 15px !important;
    }

    .main-logo-rwo img {
      height: 60px !important;
      width: 60px !important;
    }

    .row.main-rol-headdata .mian-col-purchase .main-table .main-table td {
      padding: 0px 0px !important;
      color: #000 !important;
      font-size: 6px !important;
    }

    .col-md-8.col-sm-6.first-col {
      position: relative;
      z-index: 1000000;
      margin: 0px !important;
      padding: 0px 30px 0px 30px !important;
    }

    .first-col .main-logo-rwo {
      width: 950 !important;
      padding: 0px !important;
    }

    .first-col .second-row-logo .main-sec-first {
      max-width: 200px !important;
      width: 200px !important;
    }

    .first-col .second-row-logo .main-sec-last {
      width: 200px !important;
      max-width: 200px !important;
    }

    .row.main-rol-headdata .mian-col-purchase {
      width: 950px !important;
      max-width: 950px !important;
      padding: 0px 30px 0px 0px !important;
      margin: 0px !important;
    }

    /* .mian-col-purchase .main-table td {
      padding: 0px 0px ;
      color: #000 !important;
      font-size: 10px ;
    } */

    .row.main-rol-headdata {
      padding: 10px 0px !important;
    }

    .first-col {
      width: 100% !important;
      /* margin-left: -60px !important; */
      /* padding-left: 50px !important; */
    }

    /* .mian-col-purchase {
      width: 60% !important;
      padding-top:30px;
    } */
    .row.main-rol-headdata {
      padding: 0px !important;
      margin: 0px !important;
      display: flex;
      width: 100% !important;
    }

    .main-logo-rwo {
      display: flex;
      /* width: 100% !important; */
      padding-bottom: 0px !important;
      padding: 0px !important;
      margin: 0px !important;
    }

    .first-col .mian-new-details h4 {
      font-size: 16px !important;
      font-weight: 200 !important;
    }

    .mian-new-details p {
      font-size: 7px !important;
      font-weight: 100 !important;
      color: #000;
    }

    .row.mian-foot-row {
      display: flex;
    }

    .mian-foot-last {
      width: 100% !important;
      margin: 0px !important;
      padding: 0px !important;
      margin: 0px !important;
      /* padding: 20px !important; */
    }

    .mian-foot-first {
      width: 100% !important;
      /* padding: 20px !important; */
      margin: 0px !important;
      padding-left: 30px !important;
    }

    .mian-foot-first p {
      font-size: 8px !important;
      margin: 0 0 4px !important;
    }

    .mian-foot-first h4 {
      font-size: 8px !important;
    }

    .mian-foot-first h5 {
      font-size: 8px !important;
    }

    .table_space {
      width: 100% !important;
      height: 500px !important;
    }

    .main-sec-first {
      width: 100% !important;
    }

    .main-sec-first p {
      font-size: 10px
    }

    .main-sec-first h4 {
      margin-top: 20px !important;
      font-size: 12px;
      font-weight: 200;
    }

    .main-sec-first p {
      font-size: 8px !important;

    }

    .main-sec-last p {
      font-size: 8px !important;
    }

    .main>thead>tr>th {
      background-color: #e6e6e6 !important;
      font-size: 9px !important;
      border: 2px solid #000 !important;
    }

    .main>tbody>tr>td {
      font-size: 9px !important;
      border: 2px solid #e6e6e6 !important;
    }

    .table>tbody>tr>th {
      font-size: 9px !important;
    }

    .table>tbody>tr>th {
      font-size: 9px !important;
    }

    .modal-header {
      padding: 0px 0px !important;
    }

    .print_last {
      display: flex !important;
    }

    .print_last p {
      font-size: 8px !important;
      color: #cacaca !important;
    }

    .print_last h4 {
      font-size: 12px !important;
      color: #000 !important;
      border-top: 2px solid #000 !important;
      padding-top: 4px !important;
      text-align: center;
    }

  }











  .row.main-rol-headdata {
    padding: 10px 80px;
  }

  h4.main-head-col {
    border: 2px solid #000;
    padding: 10px !important;
    background: azure;
    text-align: center;
    font-weight: 600;
  }

  .mian-col-purchase .main-table td {
    padding: 5px 0px;
    color: #000;
    font-size: 16px;
  }

  tr.main-footer-table {
    border-top: 1px solid #000;
    border-bottom: 2px solid #000;
    color: #000 !important;
    font-size: 16px !important;
    font-weight: 600;
  }

  .main-logo-rwo {
    display: flex;
  }

  .main-logo-rwo img {
    height: 100px;
    width: 130px;
  }

  .mian-new-details h4 {
    font-size: 33px !important;
    font-weight: 700;
  }

  .mian-new-details p {
    font-size: 14px;
    margin-right: 92px !important;
    color: #000;
  }

  .main-logo-rwo {
    border-bottom: 3px solid #000;
    padding-bottom: 13px !important;
    padding-left: 0px !important;
  }

  .second-row-logo {
    display: flex;
    width: 100% !important;
    padding-top: 5px !important;
  }

  .main-sec-first {
    width: 100% !important;
  }

  .main-sec-last {
    width: 100% !important;
  }

  .row.mian-foot-row {
    display: flex;
  }

  .mian-foot-last {
    width: 50% !important;
    margin: 0px !important;
    padding: 20px !important;
  }

  .mian-foot-first {
    width: 50%;
    padding: 20px;
    margin: 0px;
  }

  .modal-body {
    margin: 0px !important;
    padding: 0px !important;
  }

  .print_last {
    display: none;
  }
</style>
<div style="background-color: #FFF !important; max-width:100% !important;" class="photo">
  <div class="modal-header">

    <button type="button" class="close no-print" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    @if($purchase->type == 'purchase_order')
    @php
    $title = __('PURCHASE ORDER') ;
    $custom_labels = json_decode(session('business.custom_labels'), true);
    @endphp

    @elseif($purchase->type == 'purchase_return')
    @php
    $title = __('PURCHASE RETURN');
    $custom_labels = json_decode(session('business.custom_labels'), true);
    @endphp
    @elseif($purchase->type == 'Purchase Requisition')
    @php
    $title = __('Purchase Requisition');
    $custom_labels = json_decode(session('business.custom_labels'), true);
    @endphp
    @elseif($purchase->type == 'purchase')
    @php
    $title = __('GRN');
    $custom_labels = json_decode(session('business.custom_labels'), true);
    @endphp
    @endif


    <!-- <h4 class="modal-title" id="modalTitle"> {{$title}} </h4> -->

    <div class="row main-rol-headdata">

      <!-- main div logo start -->

      <div class="col-md-8 col-sm-6 first-col">

        <div class="main-logo-rwo">
          <!--<img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSXuKSLlddM-7fFkiXPcYHx_0uc9xTM4-Et3amUtDMe_w&s" alt="Girl in a jacket" width="150" height="150">-->

      @if(!empty(Session::get('business.logo')))
                  <img src="{{ asset( 'uploads/business_logos/' . Session::get('business.logo') ) }}" width="150" height="150" alt="Logo">
                @endif
          <div class="mian-new-details">
            <h4> <span class="logo-lg">{{ Session::get('business.name') }} <i class="fa fa-circle text-success" id="online_indicator"></i></span> </h4>
            <p>
                <!--Plot No. 134 , 135 Sector 15, Korangi Industrial Area, Karachi, Pakistan.-->
                {{ $purchase->location->name.", ".$purchase->location->city.", ".$purchase->location->state.", ".$purchase->location->country.", ".$purchase->location->zip_code }} 
            </p>
          </div>

        </div>

        <div class="second-row-logo">

          <div class="main-sec-first">
            @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase_return')
            <p> Printer on:</p>
            <p><b>Supplier:</b></p>
            @if(!empty($purchase->contact->supplier_business_name))
            <h4>{{ $purchase->contact->supplier_business_name }}</h4>
            @endif
            <p>GST NO: {{$purchase->contact->gst_no??''}} </p>
            <p>NTN/CNIC NO: {{$purchase->contact->ntn_cnic_no??''}}</p>
            <p>Refrence No: {{$purchase->ref_no}}</p>
            @elseif($purchase->type == 'purchase')
            <p> Printer on:</p>
            <p>Supplier:</p>
            @if(!empty($purchase->contact->supplier_business_name))
            <h4>{{ $purchase->contact->supplier_business_name }}</h4>
            @endif
            @endif
          </div>
          @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase_return')
          <div class="main-sec-last">
            <p><b>Contact Person:</b></p>
            <p><b>Supplier Address:</b></p>
            <p> {{$purchase->location->city}}</p>
            <p>Telephone No:</p>
            <p> Cell No: {{$purchase->contact->mobile??''}}</p>
          </div>
          @endif

        </div>

      </div>
      <!-- main div logo end -->

      <!-- main div purchase start -->

      <div class="col-md-4 col-sm-6 mian-col-purchase">


        <h4 class="main-head-col">{{$title}}</h4>

        <table class="table-responsive main-table" style="width:100%">
          @if($purchase->type == 'purchase_order')
          <tr>
            <td>Document No:</td>
            <td> {{$purchase->ref_no}}</td>

          </tr>
          <tr>
            <td>Document Date:</td>
            <td></td>

          </tr>

          <tr>
            <td>Delivery Date:</td>
            <td>{{ @format_date($purchase->delivery_date) }}</td>

          </tr>

          <tr>
            <td>Type:</td>
            <td>Item P.O</td>

          </tr>

          <tr>
            <td>Posting Date</td>
            <td>{{ @format_date($purchase->posting_date) }}</td>

          </tr>
          <tr>
            <td>PO Revised:</td>
            <td></td>

          </tr>

          <tr>
            <td>Revised Date:</td>
            <td></td>

          </tr>
          @elseif($purchase->type == 'purchase_return')
          <tr>
            <td>Document No:</td>
            <td>{{$purchase->ref_no}}</td>

          </tr>
          <tr>
            <td>Document Date:</td>
            <td></td>

          </tr>

          <tr>
            <td>Due Date:</td>
            <td></td>

          </tr>

          <tr>
            <td>Type:</td>
            <td>Item Payment Invoice</td>

          </tr>

          <tr>
            <td>Posting Date</td>
            @if(!empty($purchase->transaction_date))
            <td>{{ @format_date($purchase->transaction_date) }}</td>
            @endif
          </tr>

          @elseif($purchase->type == 'purchase')
          <tr>
            <td>Document No:</td>
            <td>{{$purchase->ref_no}}</td>
          </tr>
          <tr>
            <td>Posting Date</td>
            <td>{{ @format_date($purchase->posting_date) }}</td>
          </tr>
          <tr>
            <!--<td>Delivery Date:</td>-->
            <!--<td>{{ @format_date($purchase->delivery_date) }}</td>-->
          </tr>
          <tr>
            <td>Delivery Challan:</td>
            <td></td>
          </tr>
          @endif
        </table>
      </div>

      <!-- main div purchase end -->

    </div>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-sm-12 col-xs-12 table_space">
        <div class="table-responsive third.row">
          <table class="table bg-gray main">
            <thead>
              <tr class="bg-green">

                <th>SR. NO</th>

                @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
                <th>@if($purchase->type == 'purchase_order')
                  @lang('Purchase Request No')
                  @elseif($purchase->type == 'purchase')
                  @lang('PURCHASE ORDER NO')
                  @endif
                </th>
                @endif

                @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
                <th>@lang('Item Code')</th>
                @endif

                <th>@if($purchase->type == 'purchase_order')
                  @lang('Description')
                  @elseif($purchase->type == 'purchase_return')
                  @lang('ITEM CODE <br>
                  SPECS. OF ITEM')
                  @elseif($purchase->type == 'purchase')
                  @lang('SPECS. OF ITEM')
                  @endif
                </th>

                <th class="text-right">
                  @if($purchase->type == 'purchase_order')
                  @lang('UOM')
                  @elseif($purchase->type == 'purchase' || $purchase->type == 'purchase_return' )
                  @lang('UOM')
                </th>
                @endif
                @if($purchase->type == 'purchase_return')
                <th class="text-right">@lang('Received Quantity')</th>
                <th class="text-right">@lang('Unit Price')</th>
                <th class="text-right">@lang('Total Value')</th>
                <th class="text-right">@lang('Tax Amount')</th>
                <th class="text-right">@lang('Total Value')</th>
                @endif
                @if($purchase->type == 'purchase')
                <th class="text-right">@lang('Ordered Quantity')</th>
                <th class="text-right">@lang('Return Quantity')</th>
                <th class="text-right">@lang('Received Quantity')</th>
                @endif
                @if($purchase->type == 'purchase_order')
                <th class="text-right">@lang('Quantity')</th>
                <th class="text-right">@lang( 'Unit Price' )</th>
                <th class="text-right">@lang( 'Discount %' )</th>
                <th class="no-print text-right">@lang('Net Total')</th>
                <th class="text-right">@lang('Sales Tax')</th>
                <th class="text-right">@lang('Tax Amount')</th>
                <th class="text-right">@lang('Total value')</th>
                @endif
                @if($purchase->type != 'purchase_order' && $purchase->type != 'purchase' && $purchase->type != 'purchase_return')
                <th class="text-right">@lang('purchase.unit_selling_price')</th>
                @if(session('business.enable_lot_number'))
                <th>@lang('lang_v1.lot_number')</th>
                @endif
                @if(session('business.enable_product_expiry'))
                <th>@lang('product.mfg_date')</th>
                <th>@lang('product.exp_date')</th>
                @endif
                @endif
              </tr>
            </thead>

            @php
            $total_before_tax = 0.00;
            @endphp
            @foreach($purchase->purchase_lines as $purchase_line)
            <tr>
              <td>{{ $loop->iteration }}</td>

              @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
              <td>
                {{ $purchase_line->product->name }}
                @if( $purchase_line->product->type == 'variable')
                - {{ $purchase_line->variations->product_variation->name}}
                - {{ $purchase_line->variations->name}}
                @endif
              </td>
              @endif

              @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
              <td>
                @if( $purchase_line->product->type == 'variable')
                {{ $purchase_line->variations->sub_sku}}
                @else
                {{ $purchase_line->product->sku }}
                @endif
              </td>
              @endif

              @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
              <td>{{$purchase_line->item_description}}</td>

              @elseif($purchase->type == 'purchase_return')

              <td>
                (@if( $purchase_line->product->type == 'variable')
                {{ $purchase_line->variations->sub_sku}}
                @else
                {{ $purchase_line->product->sku }}
                @endif)
                {{$purchase_line->item_description}}
              </td>
              @endif
              <td class="text-right">{{$purchase_line->product->unit->actual_name}}</td>

              @if($purchase->type == 'purchase')
              <td class="text-right">0.00</td>
              <td class="text-right">{{$purchase_line->quantity_returned}}</td>
              <td class="text-right">0.00</td>
              @elseif($purchase->type == 'purchase_order')
              <td><span class="" data-is_quantity="true" data-currency_symbol="false">{{ $purchase_line->quantity }}</span> </td>
              <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->pp_without_discount}}</span></td>
              <td class="text-right"><span class="">{{ $purchase_line->discount_percent}}</span> %</td>
              <td class="no-print text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->quantity * $purchase_line->purchase_price }}</span></td>
              <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->item_tax }} </span> <br /><small>@if(!empty($taxes[$purchase_line->tax_id])) ( {{ $taxes[$purchase_line->tax_id]}} ) </small>@endif</td>
              <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->purchase_price_inc_tax }}</span></td>
              @elseif($purchase->type == 'purchase_return')
              <td class="text-right">{{$purchase_line->quantity_returned}}</td>
              <td class="text-right">{{ $purchase_line->pp_without_discount}}</td>
              <td class="no-print text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->quantity * $purchase_line->purchase_price }}</span></td>
              <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->item_tax }} </span> <br /><small>@if(!empty($taxes[$purchase_line->tax_id])) ( {{ $taxes[$purchase_line->tax_id]}} ) </small>@endif</td>
              <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->purchase_price_inc_tax }}</span></td>
              @endif
              @if($purchase->type != 'purchase_order' && $purchase->type != 'purchase' && $purchase->type != 'purchase_return' )
              @php
              $sp = $purchase_line->variations->default_sell_price;
              if(!empty($purchase_line->sub_unit->base_unit_multiplier)) {
              $sp = $sp * $purchase_line->sub_unit->base_unit_multiplier;
              }
              @endphp
              <td class="text-right"><span class="" data-currency_symbol="true">{{$sp}}</span></td>

              @if(session('business.enable_lot_number'))
              <td>{{$purchase_line->lot_number}}</td>
              @endif

              @if(session('business.enable_product_expiry'))
              <td>
                @if(!empty($purchase_line->mfg_date))
                {{ @format_date($purchase_line->mfg_date) }}
                @endif
              </td>
              <td>
                @if(!empty($purchase_line->exp_date))
                {{ @format_date($purchase_line->exp_date) }}
                @endif
              </td>
              @endif
              @endif
              @if($purchase->type == 'purchase_order')
              <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->purchase_price_inc_tax * $purchase_line->quantity }}</span></td>
              @endif
            </tr>
            @php
            $total_before_tax += ($purchase_line->quantity * $purchase_line->purchase_price);
            @endphp
            @endforeach
          </table>
        </div>
      </div>
    </div>
    <br>
    <div class="row mian-foot-row">
      @if($purchase->type == 'purchase_order')

      <div class="col-md-6 col-sm-12 col-xs-12 mian-foot-first">
        <p>Payment Term :<b>{{ $purchase->pay_term_number." ".$purchase->pay_term_type  }}</b></p>
        <p>Inco Term :<b>DAP</b></p>
        <p>Document Remarks:</p>
        <!--<p>Delivery will be as per {{ Session::get('business.name') }} instructon</p>-->
        <p>{{ $purchase->additional_notes  }}</p>
        <h5>Total Amount In Words:<b>{{$final_total??''}}</b></h5>
        <h4><b>Terms & Condition</b></h4>

        <p>{!! $purchase->tandc_title !!}</p>

        <p><b>GST No:{{$purchase->contact->gst_no??''}}</b></p>
        <p><b>NTN/CNIC No:{{$purchase->contact->ntn_cnic_no??''}}</b></p>




      </div>
      <div class="col-md-6 col-sm-12 col-xs-12 mian-foot-last @if($purchase->type == 'purchase_order') col-md-offset-6 @endif">
        <div class="table-responsive">
          <table class="table table_bottom">
            <!-- <tr class="hide">
          <th>@lang('purchase.total_before_tax'): </th>
          <td></td>
          <td><span class=" pull-right">{{ $total_before_tax }}</span></td>
        </tr> -->
            <tr>
              <th>@lang('Total Value'): </th>
              <td></td>
              <td><span class=" pull-right" data-currency_symbol="true">{{ $total_before_tax }}</span></td>
            </tr>
            <tr>
              <th>@lang('Discount'):</th>
              <td>
                <b>(-)</b>
                @if($purchase->discount_type == 'percentage')
                ({{$purchase->discount_amount}} %)
                @endif
              </td>
              <td>
                <span class=" pull-right" data-currency_symbol="true">
                  @if($purchase->discount_type == 'percentage')
                  {{$purchase->discount_amount * $total_before_tax / 100}}
                  @else
                  {{$purchase->discount_amount}}
                  @endif
                </span>
              </td>
            </tr>
            <tr>
              <th>@lang('Tax'):</th>
              <td><b>(+)</b></td>
              <td class="text-right">
                @if(!empty($purchase_taxes))
                @foreach($purchase_taxes as $k => $v)
                <strong><small>{{$k}}</small></strong> - <span class=" pull-right" data-currency_symbol="true">{{ $v }}</span><br>
                @endforeach
                @else
                0.00
                @endif
              </td>
            </tr>
            <tr>
              <th>@lang('Total Amount'):</th>
              <td></td>
              <td><span class=" pull-right" data-currency_symbol="true">{{ $purchase->final_total }}</span></td>
            </tr>
          </table>
        </div>
      </div>
      @endif
    </div>
    <div class="row print_last">
      <div class="col-md-4 " style="width: 36%;">
        <p>This is system generated document and does not required any signature.</p>
      </div>
      <div class="col-md-4" style="width: 32%;">
        <h4>Prepared By</h4>
      </div>
      <div class="col-md-4" style="width: 32%;">
        <h4>for Al madina oil</h4>
      </div>
    </div>
    {{-- Barcode --}}
    <!-- <div class="row print_section">
    <div class="col-xs-12">
      <img class="center-block" src="data:image/png;base64,{{DNS1D::getBarcodePNG($purchase->ref_no, 'C128', 2,30,array(39, 48, 54), true)}}">
    </div>
  </div> -->
  </div>
</div>
<div class="card-body" style="display: none;">
  <table id="employee_data" class="table table-striped table-bordered">
    <thead>
      <tr class="bg-green">
        <th>SR. NO</th>
        @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase_return')
        <th>Supplier</th>
        <th>GST NO</th>
        <th>NTN/CNIC NO</th>
        <th>Refrence No</th>
        <th>Supplier Address</th>
        <th>Cell No</th>
        @endif
@if($purchase->type == 'purchase_order')
          <th>Document No</th>
          <th>Document Date</th>
          <th>Delivery Date</th>
          <th>Type</th>
          <th>Posting Date</th>
          <th>PO Revised</th>
          <th>Revised Date</th>
        @elseif($purchase->type == 'purchase_return')

          <th>Document No</th>
          <th>Document Date</th>
          <th>Due Date</th>
          <th>Type</th>
          <th>Posting Date</th>
        @elseif($purchase->type == 'purchase')
          <th>Document No</th>
          <th>Posting Date</th>
          <th>Delivery Challan:</th>
        @endif


        @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
        <th>@if($purchase->type == 'purchase_order')
          @lang('Purchase Request No')
          @elseif($purchase->type == 'purchase')
          @lang('PURCHASE ORDER NO')
          @endif
        </th>
        @endif

        @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
        <th>@lang('Item Code')</th>
        @endif

        <th>@if($purchase->type == 'purchase_order')
          @lang('Description')
          @elseif($purchase->type == 'purchase_return')
          @lang('ITEM CODE <br>
          SPECS. OF ITEM')
          @elseif($purchase->type == 'purchase')
          @lang('SPECS. OF ITEM')
          @endif
        </th>

        <th class="text-right">
          @if($purchase->type == 'purchase_order')
          @lang('UOM')
          @elseif($purchase->type == 'purchase' || $purchase->type == 'purchase_return' )
          @lang('UOM')
        </th>
        @endif
        @if($purchase->type == 'purchase_return')
        <th class="text-right">@lang('Received Quantity')</th>
        <th class="text-right">@lang('Unit Price')</th>
        <th class="text-right">@lang('Total Value')</th>
        <th class="text-right">@lang('Tax Amount')</th>
        <th class="text-right">@lang('Total Value')</th>
        @endif
        @if($purchase->type == 'purchase')
        <th class="text-right">@lang('Ordered Quantity')</th>
        <th class="text-right">@lang('Return Quantity')</th>
        <th class="text-right">@lang('Received Quantity')</th>
        @endif
        @if($purchase->type == 'purchase_order')
        <th class="text-right">@lang('Quantity')</th>
        <th class="text-right">@lang( 'Unit Price' )</th>
        <th class="text-right">@lang( 'Discount %' )</th>
        <th class="no-print text-right">@lang('Net Total')</th>
        <th class="text-right">@lang('Sales Tax')</th>
        <th class="text-right">@lang('Tax Amount')</th>
        <th class="text-right">@lang('Total value')</th>
        @endif
        @if($purchase->type != 'purchase_order' && $purchase->type != 'purchase' && $purchase->type != 'purchase_return')
        <th class="text-right">@lang('purchase.unit_selling_price')</th>
        @if(session('business.enable_lot_number'))
        <th>@lang('lang_v1.lot_number')</th>
        @endif
        @if(session('business.enable_product_expiry'))
        <th>@lang('product.mfg_date')</th>
        <th>@lang('product.exp_date')</th>
        @endif
        @endif
      </tr>
    </thead>
    @php
    $total_before_tax = 0.00;
    @endphp
    @foreach($purchase->purchase_lines as $purchase_line)
    <tr>

      <td>{{ $loop->iteration }}</td>
      @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase_return')

      @if(!empty($purchase->contact->supplier_business_name))
      <td>{{ $purchase->contact->supplier_business_name }}</td>
      @endif
      <td>{{$purchase->contact->gst_no??''}}</td>
      <td>{{$purchase->contact->ntn_cnic_no??''}}</td>
      <td>{{$purchase->ref_no}}</td>
      <td>{{$purchase->location->city}}</td>
      <td>{{$purchase->contact->mobile??''}}</td>
      @endif

      @if($purchase->type == 'purchase_order')
        
          <td> {{$purchase->ref_no}}</td>  
          <td></td>
          <td>{{ @format_date($purchase->delivery_date) }}</td>
          <td>Item P.O</td>
          <td>{{ @format_date($purchase->posting_date) }}</td>
          <td></td>
          <td></td>

        @elseif($purchase->type == 'purchase_return')
          <td>{{$purchase->ref_no}}</td>
          <td></td>
          <td></td>
          <td>Item Payment Invoice</td>
          <td>{{ @format_date($purchase->transaction_dateZ) }}</td>

        @elseif($purchase->type == 'purchase')
  
          <td>{{$purchase->ref_no}}</td>
          <td>{{ @format_date($purchase->posting_date) }}</td>
          <td></td>
        @endif



      @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
      <td>
        {{ $purchase_line->product->name }}
        @if( $purchase_line->product->type == 'variable')
        - {{ $purchase_line->variations->product_variation->name}}
        - {{ $purchase_line->variations->name}}
        @endif
      </td>
      @endif

      @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
      <td>
        @if( $purchase_line->product->type == 'variable')
        {{ $purchase_line->variations->sub_sku}}
        @else
        {{ $purchase_line->product->sku }}
        @endif
      </td>
      @endif

      @if($purchase->type == 'purchase_order' || $purchase->type == 'purchase')
      <td>{{$purchase_line->item_description}}</td>

      @elseif($purchase->type == 'purchase_return')

      <td>
        (@if( $purchase_line->product->type == 'variable')
        {{ $purchase_line->variations->sub_sku}}
        @else
        {{ $purchase_line->product->sku }}
        @endif)
        {{$purchase_line->item_description}}
      </td>
      @endif
      <td class="text-right">{{$purchase_line->product->unit->actual_name}}</td>

      @if($purchase->type == 'purchase')
      <td class="text-right">0.00</td>
      <td class="text-right">{{$purchase_line->quantity_returned}}</td>
      <td class="text-right">0.00</td>
      @elseif($purchase->type == 'purchase_order')
      <td><span class="" data-is_quantity="true" data-currency_symbol="false">{{ $purchase_line->quantity }}</span> </td>
      <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->pp_without_discount}}</span></td>
      <td class="text-right"><span class="">{{ $purchase_line->discount_percent}}</span> %</td>
      <td class="no-print text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->quantity * $purchase_line->purchase_price }}</span></td>
      <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->item_tax }} </span> <br /><small>@if(!empty($taxes[$purchase_line->tax_id])) ( {{ $taxes[$purchase_line->tax_id]}} ) </small>@endif</td>
      <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->purchase_price_inc_tax }}</span></td>
      @elseif($purchase->type == 'purchase_return')
      <td class="text-right">{{$purchase_line->quantity_returned}}</td>
      <td class="text-right">{{ $purchase_line->pp_without_discount}}</td>
      <td class="no-print text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->quantity * $purchase_line->purchase_price }}</span></td>
      <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->item_tax }} </span> <br /><small>@if(!empty($taxes[$purchase_line->tax_id])) ( {{ $taxes[$purchase_line->tax_id]}} ) </small>@endif</td>
      <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->purchase_price_inc_tax }}</span></td>
      @endif
      @if($purchase->type != 'purchase_order' && $purchase->type != 'purchase' && $purchase->type != 'purchase_return' )
      @php
      $sp = $purchase_line->variations->default_sell_price;
      if(!empty($purchase_line->sub_unit->base_unit_multiplier)) {
      $sp = $sp * $purchase_line->sub_unit->base_unit_multiplier;
      }
      @endphp
      <td class="text-right"><span class="" data-currency_symbol="true">{{$sp}}</span></td>

      @if(session('business.enable_lot_number'))
      <td>{{$purchase_line->lot_number}}</td>
      @endif

      @if(session('business.enable_product_expiry'))
      <td>
        @if(!empty($purchase_line->mfg_date))
        {{ @format_date($purchase_line->mfg_date) }}
        @endif
      </td>
      <td>
        @if(!empty($purchase_line->exp_date))
        {{ @format_date($purchase_line->exp_date) }}
        @endif
      </td>
      @endif
      @endif
      @if($purchase->type == 'purchase_order')
      <td class="text-right"><span class="" data-currency_symbol="true">{{ $purchase_line->purchase_price_inc_tax * $purchase_line->quantity }}</span></td>
      @endif
    </tr>
    @php
    $total_before_tax += ($purchase_line->quantity * $purchase_line->purchase_price);
    @endphp
    @endforeach
  </table>
</div>